<?xml version="1.0" encoding="utf-8"?>
<Page
    x:Class="MediaTrackMixerPage.MediaTrackMixerMainPage"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:viewModels="using:MediaTrackMixerPage.ViewModels"
    mc:Ignorable="d"
    NavigationCacheMode="Enabled">

    <Grid AllowDrop="True" Drop="MainPage_OnDrop" DragOver="MainPage_OnDragOver" Margin="10" HorizontalAlignment="Center" VerticalAlignment="Center">
        <RelativePanel Visibility="{x:Bind _mainModel.HasTracks, Mode=OneWay}">
            <RelativePanel.Resources>
                <CollectionViewSource x:Name="CollectionViewSourcee" IsSourceGrouped="True" />
            </RelativePanel.Resources>
            <Grid RelativePanel.Above="ButtonsGrid" RelativePanel.AlignLeftWithPanel="True" RelativePanel.AlignRightWithPanel="True">
                <ListView x:Name="ListVieww" SelectionMode="Multiple" Margin="0, 0, 0, 10" HorizontalAlignment="Center"
                          SelectionChanged="TrackSelectionChanged" ItemTemplate="{StaticResource TrackTemplate}">
                    <ListView.GroupStyle>
                        <GroupStyle>
                            <GroupStyle.HeaderTemplate>
                                <DataTemplate x:DataType="viewModels:TrackGroup">
                                    <Grid Height="40">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="30" />
                                            <ColumnDefinition Width="30" />
                                            <ColumnDefinition Width="*" />
                                            <ColumnDefinition Width="50" />
                                        </Grid.ColumnDefinitions>
                                        <CheckBox Margin="2,0,0,0" Checked="TrackGroupChecked"
                                                  Unchecked="TrackGroupChecked" IsChecked="{x:Bind Checked, Mode=OneWay}">
                                        </CheckBox>
                                        <Ellipse Grid.Column="1" Fill="{x:Bind Colour.Background}" Stroke="Black" Width="15" Height="15" />
                                        <TextBlock Grid.Column="2" VerticalAlignment="Center" ToolTipService.ToolTip="{x:Bind FullPath}"
                                                   Text="{x:Bind FileName}" TextTrimming="CharacterEllipsis">
                                        </TextBlock>
                                        <Button Grid.Column="3" HorizontalAlignment="Right">
                                            <SymbolIcon Symbol="More" />
                                            <Button.Flyout>
                                                <MenuFlyout>
                                                    <MenuFlyoutItem Text="Select video and audio" Click="SelectVideoAndAudio">
                                                        <MenuFlyoutItem.Icon>
                                                            <FontIcon Glyph="&#xEA69;" />
                                                        </MenuFlyoutItem.Icon>
                                                    </MenuFlyoutItem>
                                                    <MenuFlyoutItem Text="Select subtitles" Click="SelectSubtitles">
                                                        <MenuFlyoutItem.Icon>
                                                            <FontIcon Glyph="&#xED1E;" />
                                                        </MenuFlyoutItem.Icon>
                                                    </MenuFlyoutItem>
                                                    <MenuFlyoutItem Text="Remove media" Click="TrackGroupDeleted">
                                                        <MenuFlyoutItem.Icon>
                                                            <SymbolIcon Symbol="Delete" Foreground="{ThemeResource SystemFillColorCriticalBrush}" />
                                                        </MenuFlyoutItem.Icon>
                                                    </MenuFlyoutItem>
                                                </MenuFlyout>
                                            </Button.Flyout>
                                        </Button>
                                    </Grid>
                                </DataTemplate>
                            </GroupStyle.HeaderTemplate>
                            <GroupStyle.HeaderContainerStyle>
                                <Style TargetType="ListViewHeaderItem">
                                    <Setter Property="HorizontalContentAlignment" Value="Stretch" />
                                </Style>
                            </GroupStyle.HeaderContainerStyle>
                        </GroupStyle>
                    </ListView.GroupStyle>
                </ListView>
            </Grid>
            <Grid x:Name="ButtonsGrid" RelativePanel.AlignBottomWithPanel="True" RelativePanel.AlignLeftWithPanel="True" RelativePanel.AlignRightWithPanel="True">
                <StackPanel Orientation="Horizontal" Spacing="10" HorizontalAlignment="Center">
                    <Button Click="ShowFilePicker" Width="150">
                        <StackPanel Orientation="Horizontal" Spacing="10">
                            <SymbolIcon Symbol="Upload" />
                            <TextBlock HorizontalTextAlignment="Center">Add media</TextBlock>
                        </StackPanel>
                    </Button>
                    <Button Click="RemoveAllMedia" Width="150">
                        <StackPanel Orientation="Horizontal" Spacing="10">
                            <SymbolIcon Symbol="Delete" Foreground="{ThemeResource SystemFillColorCriticalBrush}"/>
                            <TextBlock HorizontalTextAlignment="Center">Remove all</TextBlock>
                        </StackPanel>
                    </Button>
                    <Button Click="GoBack" Width="150">
                        <StackPanel Orientation="Horizontal" Spacing="10">
                            <SymbolIcon Symbol="Back" />
                            <TextBlock HorizontalTextAlignment="Center">Go back</TextBlock>
                        </StackPanel>
                    </Button>
                    <Button Click="GoToNextPage" Width="150" Style="{StaticResource AccentButtonStyle}" IsEnabled="{x:Bind _mainModel.HasSelectedTracks, Mode=OneWay}">
                        <StackPanel Orientation="Horizontal" Spacing="10">
                            <SymbolIcon Symbol="Forward" />
                            <TextBlock HorizontalTextAlignment="Center">Ready</TextBlock>
                        </StackPanel>
                    </Button>
                </StackPanel>
            </Grid>
        </RelativePanel>
        <Grid Visibility="{x:Bind _mainModel.HasNoTracks, Mode=OneWay}" BorderBrush="{ThemeResource SurfaceStrokeColorDefaultBrush}" BorderThickness="2"
              CornerRadius="{StaticResource OverlayCornerRadius}" Width="500" Height="500" Background="Transparent">
            <Button Padding="10" Click="ShowFilePicker" HorizontalAlignment="Center" VerticalAlignment="Center">
                <StackPanel>
                    <Viewbox MaxWidth="100" Margin="10">
                        <SymbolIcon Symbol="Upload" />
                    </Viewbox>
                    <TextBlock HorizontalTextAlignment="Center" Style="{StaticResource BaseTextBlockStyle}">Add media</TextBlock>
                </StackPanel>
            </Button>
        </Grid>
    </Grid>
</Page>
